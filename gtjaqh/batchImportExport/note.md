### 批量导入

- 上传

校验文件大小，文件格式（xlsx，xls，csv）

#### 逻辑：

##### 校验：

登录校验

校验管理员

文件大小校验

文件格式校验

##### 解析文件（分不同的格式）:

编码格式utf-8，注意：转换成csv文件如果不是utf-8还需要转码（存在utf-8 bom格式 读取时会产生多余编码符号），xls的转换不能直接改后缀名，需要另存为选择格式

##### 业务逻辑处理：

先去重，当手机号或邮箱有一处相同时则认为是重复数据（避免导入并发时添加相同的号码报错）

读取完所有数据后存入map数组中，

5个一组采用异步的方式，20条数据则开4个子线程来处理，

等待时间为4s

##### 结果数据处理：

有成功上传的成员则返回上传时间，并检测是否为多实控用户（前端检测到为多实控用户后则弹窗并添加用户选择的选项字段optionId，导入成功后返回成功信息还需前端调用记录接口记录到库中）

失败成员返回失败信息

- 导入

查询t_company_user表来分为添加用户和更新用户两类。

异步添加用户

异步更新用户

添加或更新成功后返回成功用户

添加或更新失败后还要返回失败信息字段表示失败原因



### 批量导出

**导出成员**

**导出成员及资产账号**

不勾选选框则默认导出所有用户，并弹出弹窗提示是否导出离职用户

用户存在多个部门则逗号分隔显示
